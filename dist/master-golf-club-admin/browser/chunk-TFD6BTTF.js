import{a as Z,b as ee,c as P}from"./chunk-AUROHWJP.js";import{Ja as H}from"./chunk-IU3BDYHA.js";import{a as re}from"./chunk-DVM5LER3.js";import{Ea as G,Ia as J,Ka as K,Pa as Q,Q as U,R as O,b as k,c as B,cb as X,d as V,f as R,g as A,ha as j,la as W,ra as Y,sa as $,ta as z}from"./chunk-RS62WWGD.js";import{Ib as s,Jb as i,Kb as T,Ob as x,Sb as y,Tb as d,Z as L,bb as l,cb as v,cc as c,dc as p,ec as S,ha as w,hc as b,ic as I,jc as F,lc as M,nc as C,oc as N,qc as D,sa as f,sb as _,ta as E,yb as u}from"./chunk-NP3QOLCN.js";import{f as ne,k as q}from"./chunk-AAPNLDO3.js";var g=ne(re());var te=(()=>{let r=class r{constructor(){this.apiUrl=new Z().getUrl(ee),this.lists=this.apiUrl+"contactEnquiry/0/listing/",this.processing=this.apiUrl+"contactEnquiry/0/processing/",this.deletion=this.apiUrl+"contactEnquiry/0/deletion/"}listEnquiry(e="0"){return P.get(this.lists.replace("0",e))}processEnquiry(e,t="0"){return P.post(this.processing.replace("0",t),e)}deleteEnquiry(e){return P.get(this.deletion.replace("0",e))}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=L({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();var ie=n=>({disabled:n}),se=n=>({active:n});function ce(n,r){if(n&1&&(s(0,"tr")(1,"td"),c(2),i(),s(3,"td"),c(4),i(),s(5,"td"),c(6),i(),s(7,"td"),c(8),i(),s(9,"td"),c(10),i(),s(11,"td"),c(12),N(13,"date"),i(),T(14,"td"),i()),n&2){let a=r.$implicit,e=r.index,t=d();l(2),p((t.currentPage-1)*t.itemsPerPage+e+1),l(2),p(a.contactEnquiryFirstName+" "+a.contactEnquiryLastName),l(2),p(a.contactEnquiryPhoneNumber),l(2),p(a.contactEnquiryEmail),l(2),p(a.contactEnquiryMessage),l(2),p(D(13,6,a.contactEnquiryDate,"mediumDate"))}}function le(n,r){if(n&1){let a=x();s(0,"c-page-item")(1,"a",9),y("click",function(){let t=f(a).$implicit,o=d(2);return E(o.changePage(t))}),c(2),i()()}if(n&2){let a=r.$implicit,e=d(2);l(),u("ngClass",C(2,se,e.currentPage===a)),l(),S(" ",a," ")}}function me(n,r){if(n&1){let a=x();s(0,"c-pagination",8)(1,"c-page-item")(2,"a",9),y("click",function(){f(a);let t=d();return E(t.previousPage())}),c(3," Previous "),i()(),_(4,le,3,4,"c-page-item",6),s(5,"c-page-item")(6,"a",9),y("click",function(){f(a);let t=d();return E(t.nextPage())}),c(7," Next "),i()()()}if(n&2){let a=d();l(2),u("ngClass",C(3,ie,a.currentPage===1)),l(2),u("ngForOf",a.pageRange),l(2),u("ngClass",C(5,ie,a.currentPage===a.totalPages))}}var qe=(()=>{let r=class r{constructor(e){this.enquiryService=e,this.icons={cilTrash:H},this.tooltipDeleteText="Delete",this.enquiryList=[],this.pageRange=[],this.currentPage=1,this.itemsPerPage=10,this.isLoading=!1,this.searchTerm=""}ngOnInit(){this.loadEnquiryList()}loadEnquiryList(){return q(this,null,function*(){if(!this.isLoading){this.isLoading=!0;try{let e=yield this.enquiryService.listEnquiry("0");e.data.code===1?(this.enquiryList=e.data.data,this.updatePageRange()):yield g.default.fire("Error","Failed to load enquiry list","error")}catch(e){console.error("Error loading enquiry list:",e),yield g.default.fire("Error","An error occurred while loading the enquiry list","error")}finally{this.isLoading=!1}}})}updatePageRange(){let e=this.totalPages,t=Math.max(1,this.currentPage-1);Math.min(e,t+2)===e&&(t=Math.max(1,e-2)),this.pageRange=Array.from({length:Math.min(3,e)},(m,h)=>t+h)}changePage(e){e>=1&&e<=this.totalPages&&!this.isLoading&&(this.currentPage=e,this.updatePageRange())}nextPage(){this.currentPage<this.totalPages&&!this.isLoading&&this.changePage(this.currentPage+1)}previousPage(){this.currentPage>1&&!this.isLoading&&this.changePage(this.currentPage-1)}search(){this.currentPage=1,this.updatePageRange()}get paginatedEnquiryList(){let e=this.enquiryList;if(this.searchTerm){let o=this.searchTerm.toLowerCase();e=this.enquiryList.filter(m=>m.contactEnquiryFirstName.toLowerCase().includes(o)||m.contactEnquiryLastName.toLowerCase().includes(o)||m.contactEnquiryEmail.toLowerCase().includes(o)||m.contactEnquiryPhoneNumber.toLowerCase().includes(o)||m.contactEnquiryMessage.toLowerCase().includes(o))}let t=(this.currentPage-1)*this.itemsPerPage;return e.slice(t,t+this.itemsPerPage)}get totalPages(){let e=this.searchTerm?this.enquiryList.filter(t=>t.contactEnquiryFirstName.toLowerCase().includes(this.searchTerm.toLowerCase())||t.contactEnquiryLastName.toLowerCase().includes(this.searchTerm.toLowerCase())||t.contactEnquiryEmail.toLowerCase().includes(this.searchTerm.toLowerCase())||t.contactEnquiryPhoneNumber.toLowerCase().includes(this.searchTerm.toLowerCase())||t.contactEnquiryMessage.toLowerCase().includes(this.searchTerm.toLowerCase())).length:this.enquiryList.length;return Math.ceil(e/this.itemsPerPage)}deleteEnquiry(e){return q(this,null,function*(){if(this.isLoading)return;if((yield g.default.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed){this.isLoading=!0;try{(yield this.enquiryService.deleteEnquiry(e.toString())).data.code===1?(yield g.default.fire("Deleted!","Enquiry has been deleted.","success"),yield this.loadEnquiryList()):yield g.default.fire("Error","Failed to delete enquiry","error")}catch(o){console.error("Error deleting enquiry:",o),yield g.default.fire("Error","An error occurred while deleting the enquiry","error")}finally{this.isLoading=!1}}})}};r.\u0275fac=function(t){return new(t||r)(v(te))},r.\u0275cmp=w({type:r,selectors:[["app-enquiry"]],standalone:!0,features:[M],decls:25,vars:6,consts:[["xs","12"],[1,"mb-4"],["md","3",1,"mb-4","flex","justify-content-md-end"],["cFormControl","","id","searchInput","type","search","placeholder","Search Enquiries",3,"input","ngModelChange","ngModel"],["cTable","",3,"hover","striped","bordered"],["scope","col"],[4,"ngFor","ngForOf"],["aria-label","Enquiry navigation",4,"ngIf"],["aria-label","Enquiry navigation"],["cPageLink","",3,"click","ngClass"]],template:function(t,o){t&1&&(s(0,"c-col",0)(1,"c-card",1)(2,"c-card-body")(3,"c-col",2)(4,"input",3),y("input",function(){return o.search()}),F("ngModelChange",function(h){return I(o.searchTerm,h)||(o.searchTerm=h),h}),i()(),s(5,"table",4)(6,"thead")(7,"tr")(8,"th",5),c(9,"S.No"),i(),s(10,"th",5),c(11,"Name"),i(),s(12,"th",5),c(13,"Phone Number"),i(),s(14,"th",5),c(15,"Email"),i(),s(16,"th",5),c(17,"Message"),i(),s(18,"th",5),c(19,"Date"),i(),s(20,"th",5),c(21,"Action"),i()()(),s(22,"tbody"),_(23,ce,15,9,"tr",6),i()(),_(24,me,8,7,"c-pagination",7),i()()()),t&2&&(l(4),b("ngModel",o.searchTerm),l(),u("hover",!0)("striped",!0)("bordered",!0),l(18),u("ngForOf",o.paginatedEnquiryList),l(),u("ngIf",o.enquiryList.length>o.itemsPerPage))},dependencies:[k,A,B,V,R,W,U,O,X,J,K,Q,j,G,z,$,Y]});let n=r;return n})();export{qe as EnquiryComponent};
