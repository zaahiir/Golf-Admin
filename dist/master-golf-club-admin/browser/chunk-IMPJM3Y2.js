import{a as Z,b as ee,c as P}from"./chunk-AUROHWJP.js";import{Ja as H}from"./chunk-IU3BDYHA.js";import{a as re}from"./chunk-DVM5LER3.js";import{Ca as G,Ga as J,Ia as K,Na as Q,O as U,P as O,ab as X,b as k,c as B,d as V,f as R,fa as j,g as A,ja as W,pa as Y,qa as $,ra as z}from"./chunk-M3QMQC54.js";import{Ib as n,Jb as i,Kb as S,Ob as q,Sb as y,Tb as p,Z as L,bb as l,cb as v,cc as c,dc as d,ec as T,ha as w,hc as b,ic as I,jc as F,lc as M,nc as C,oc as N,qc as D,sa as f,sb as _,ta as E,yb as u}from"./chunk-X7YB6HNB.js";import{f as ne,k as x}from"./chunk-AAPNLDO3.js";var g=ne(re());var te=(()=>{let a=class a{constructor(){this.apiUrl=new Z().getUrl(ee),this.lists=this.apiUrl+"contactEnquiry/0/listing/",this.processing=this.apiUrl+"contactEnquiry/0/processing/",this.deletion=this.apiUrl+"contactEnquiry/0/deletion/"}listEnquiry(e="0"){return P.get(this.lists.replace("0",e))}processEnquiry(e,t="0"){return P.post(this.processing.replace("0",t),e)}deleteEnquiry(e){return P.get(this.deletion.replace("0",e))}};a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=L({token:a,factory:a.\u0275fac,providedIn:"root"});let r=a;return r})();var ie=r=>({disabled:r}),se=r=>({active:r});function ce(r,a){if(r&1&&(n(0,"tr")(1,"td"),c(2),i(),n(3,"td"),c(4),i(),n(5,"td"),c(6),i(),n(7,"td"),c(8),i(),n(9,"td"),c(10),i(),n(11,"td"),c(12),i(),n(13,"td"),c(14),N(15,"date"),i(),S(16,"td"),i()),r&2){let o=a.$implicit,e=a.index,t=p();l(2),d((t.currentPage-1)*t.itemsPerPage+e+1),l(2),d(o.contactEnquiryFirstName),l(2),d(o.contactEnquiryLastName),l(2),d(o.contactEnquiryPhoneNumber),l(2),d(o.contactEnquiryEmail),l(2),d(o.contactEnquiryMessage),l(2),d(D(15,7,o.contactEnquiryDate,"mediumDate"))}}function le(r,a){if(r&1){let o=q();n(0,"c-page-item")(1,"a",9),y("click",function(){let t=f(o).$implicit,s=p(2);return E(s.changePage(t))}),c(2),i()()}if(r&2){let o=a.$implicit,e=p(2);l(),u("ngClass",C(2,se,e.currentPage===o)),l(),T(" ",o," ")}}function me(r,a){if(r&1){let o=q();n(0,"c-pagination",8)(1,"c-page-item")(2,"a",9),y("click",function(){f(o);let t=p();return E(t.previousPage())}),c(3," Previous "),i()(),_(4,le,3,4,"c-page-item",6),n(5,"c-page-item")(6,"a",9),y("click",function(){f(o);let t=p();return E(t.nextPage())}),c(7," Next "),i()()()}if(r&2){let o=p();l(2),u("ngClass",C(3,ie,o.currentPage===1)),l(2),u("ngForOf",o.pageRange),l(2),u("ngClass",C(5,ie,o.currentPage===o.totalPages))}}var xe=(()=>{let a=class a{constructor(e){this.enquiryService=e,this.icons={cilTrash:H},this.tooltipDeleteText="Delete",this.enquiryList=[],this.pageRange=[],this.currentPage=1,this.itemsPerPage=10,this.isLoading=!1,this.searchTerm=""}ngOnInit(){this.loadEnquiryList()}loadEnquiryList(){return x(this,null,function*(){if(!this.isLoading){this.isLoading=!0;try{let e=yield this.enquiryService.listEnquiry("0");e.data.code===1?(this.enquiryList=e.data.data,this.updatePageRange()):yield g.default.fire("Error","Failed to load enquiry list","error")}catch(e){console.error("Error loading enquiry list:",e),yield g.default.fire("Error","An error occurred while loading the enquiry list","error")}finally{this.isLoading=!1}}})}updatePageRange(){let e=this.totalPages,t=Math.max(1,this.currentPage-1);Math.min(e,t+2)===e&&(t=Math.max(1,e-2)),this.pageRange=Array.from({length:Math.min(3,e)},(m,h)=>t+h)}changePage(e){e>=1&&e<=this.totalPages&&!this.isLoading&&(this.currentPage=e,this.updatePageRange())}nextPage(){this.currentPage<this.totalPages&&!this.isLoading&&this.changePage(this.currentPage+1)}previousPage(){this.currentPage>1&&!this.isLoading&&this.changePage(this.currentPage-1)}search(){this.currentPage=1,this.updatePageRange()}get paginatedEnquiryList(){let e=this.enquiryList;if(this.searchTerm){let s=this.searchTerm.toLowerCase();e=this.enquiryList.filter(m=>m.contactEnquiryFirstName.toLowerCase().includes(s)||m.contactEnquiryLastName.toLowerCase().includes(s)||m.contactEnquiryEmail.toLowerCase().includes(s)||m.contactEnquiryPhoneNumber.toLowerCase().includes(s)||m.contactEnquiryMessage.toLowerCase().includes(s))}let t=(this.currentPage-1)*this.itemsPerPage;return e.slice(t,t+this.itemsPerPage)}get totalPages(){let e=this.searchTerm?this.enquiryList.filter(t=>t.contactEnquiryFirstName.toLowerCase().includes(this.searchTerm.toLowerCase())||t.contactEnquiryLastName.toLowerCase().includes(this.searchTerm.toLowerCase())||t.contactEnquiryEmail.toLowerCase().includes(this.searchTerm.toLowerCase())||t.contactEnquiryPhoneNumber.toLowerCase().includes(this.searchTerm.toLowerCase())||t.contactEnquiryMessage.toLowerCase().includes(this.searchTerm.toLowerCase())).length:this.enquiryList.length;return Math.ceil(e/this.itemsPerPage)}deleteEnquiry(e){return x(this,null,function*(){if(this.isLoading)return;if((yield g.default.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed){this.isLoading=!0;try{(yield this.enquiryService.deleteEnquiry(e.toString())).data.code===1?(yield g.default.fire("Deleted!","Enquiry has been deleted.","success"),yield this.loadEnquiryList()):yield g.default.fire("Error","Failed to delete enquiry","error")}catch(s){console.error("Error deleting enquiry:",s),yield g.default.fire("Error","An error occurred while deleting the enquiry","error")}finally{this.isLoading=!1}}})}};a.\u0275fac=function(t){return new(t||a)(v(te))},a.\u0275cmp=w({type:a,selectors:[["app-enquiry"]],standalone:!0,features:[M],decls:27,vars:6,consts:[["xs","12"],[1,"mb-4"],["md","3",1,"mb-4","flex","justify-content-md-end"],["cFormControl","","id","searchInput","type","search","placeholder","Search Enquiries",3,"input","ngModelChange","ngModel"],["cTable","",3,"hover","striped","bordered"],["scope","col"],[4,"ngFor","ngForOf"],["aria-label","Enquiry navigation",4,"ngIf"],["aria-label","Enquiry navigation"],["cPageLink","",3,"click","ngClass"]],template:function(t,s){t&1&&(n(0,"c-col",0)(1,"c-card",1)(2,"c-card-body")(3,"c-col",2)(4,"input",3),y("input",function(){return s.search()}),F("ngModelChange",function(h){return I(s.searchTerm,h)||(s.searchTerm=h),h}),i()(),n(5,"table",4)(6,"thead")(7,"tr")(8,"th",5),c(9,"S.No"),i(),n(10,"th",5),c(11,"First Name"),i(),n(12,"th",5),c(13,"Last Name"),i(),n(14,"th",5),c(15,"Phone Number"),i(),n(16,"th",5),c(17,"Email"),i(),n(18,"th",5),c(19,"Message"),i(),n(20,"th",5),c(21,"Date"),i(),n(22,"th",5),c(23,"Action"),i()()(),n(24,"tbody"),_(25,ce,17,10,"tr",6),i()(),_(26,me,8,7,"c-pagination",7),i()()()),t&2&&(l(4),b("ngModel",s.searchTerm),l(),u("hover",!0)("striped",!0)("bordered",!0),l(20),u("ngForOf",s.paginatedEnquiryList),l(),u("ngIf",s.enquiryList.length>s.itemsPerPage))},dependencies:[k,A,B,V,R,W,U,O,X,J,K,Q,j,G,z,$,Y]});let r=a;return r})();export{xe as EnquiryComponent};
